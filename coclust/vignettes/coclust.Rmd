---
title: "Co-clustering example"
author: "David Beley, Boubacar Sow"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Co-clustering example}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Preparation

```{r}
library(coclust)
library(blockcluster)
data("gaussiandata")
```

# coclust Package

## Co-clustering
```{r}
res <- lbvem(gaussiandata, nbcoclust = c(3, 3), init = 50)
```

Notre fonction lbvem effectue un co-clustering gaussien à modèle latent par blocs. Pour trouver les paramètres de la log-likelihood, nous avons implémenté l'algorithme VEM (Variational Expected Maximisation). Nous avons également implémenté le critère de convergence ICL (Integrated Completed Likelihood), il permet de choisir le modèle pertinent, et le nombre de composantes du modèle de mélange gaussien. 

Pour le critère de convergence  de lbvem nous avons utilisé deux méthodes :
  - pour sortir de l'algorithme VEM nous vérifions que les matrices des Paramètres estimés (moyennes et ecart-types) ne se modifie plus (écart entre l'ancienne matrice et la nouvelle < 0.1)
  - nous répéterons jusqu'à ce que le critère ICL ne bouge plus (écart entre l'ancien et le nouveau < 1) ou ne décroît plus

L'initialisation de lbvem s'est faite avec kmeans clustering par lignes et colonnes. 

Pour les jeux de données que nous avons testés, nous observons que dans certains cas, nous n'obtenons pas le même nombre clusters  initiales et finales, les clusters se vident.

## ICL
```{r}
res$icl
```


## Plot

```{r fig.height = 6, fig.width = 4, fig.align = "center"}
plot_coclust(res)
```


# Blockcluster package
## Co-clustering
```{r}
out <- coclusterContinuous(as.matrix(gaussiandata), nbcocluster = c(3, 3))
```

## ICL
```{r}
summary(out)
```

On retrouve une valeur de l'ICL proche de la valeur trouvée par notre fonction.

## Plot
```{r fig.height = 6, fig.width = 4, fig.align = "center"}
plot(out)
```
